version: "3.7"

# Configuration in this file is merged with docker-compose.yml
# You can use it to make local changes to the configuration
# Some common configurations are added in comments below
services:
  ui:
    image: brewblox/brewblox-ui:develop
    volumes:
      # Generated by running "npm run devbuild"
      - ./dev/dist:/usr/share/nginx/html/ui
      - ./docker/conf/default.conf:/etc/nginx/conf.d/default.conf
    labels:
      - traefik.http.routers.ui.rule=PathPrefix(`/ui`) || Path(`/`)

  # automation:
  #   image: brewblox/brewblox-automation:develop
  #   volumes:
  #     - "../brewblox-automation:/app"
  #   entrypoint: 'npm run watch'

  # datastore:
  #   image: treehouses/couchdb:2.3.1
  #   labels:
  #     - traefik.http.services.datastore.loadbalancer.server.port=5984
  #     - traefik.http.routers.datastore.middlewares=prefix-strip
  #   volumes:
  #     - ./dev/couchdb/:/opt/couchdb/data/

  # sparksimulator:
  #   image: brewblox/firmware-simulator:feature-multiplatform
  #   init: true
  #   ports:
  #     - "7376:7376"

  # history:
  #   volumes:
  #     - ../brewblox-history:/app

  # sparkey:
  #   volumes:
  #     - ../brewblox-devcon-spark/brewblox_devcon_spark:/app/brewblox_devcon_spark

  # spock:
  #   volumes:
  #     - ../brewblox-devcon-spark/brewblox_devcon_spark:/app/brewblox_devcon_spark
